{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-4">
  <h1 class="mb-4">Tournaments</h1>

  <div class="d-flex mb-4 gap-2">
    <a href="?status=registration"
       class="btn {% if current_status == 'registration' %}btn-light{% else %}btn-outline-light{% endif %}">
       Registration
    </a>
    <a href="?status=in_progress"
       class="btn {% if current_status == 'in_progress' %}btn-light{% else %}btn-outline-light{% endif %}">
       In progress
    </a>
  </div>

  {% if tournaments %}
    <div class="d-flex flex-column gap-4">
      {% for tournament in tournaments %}
        <div class="p-4 rounded-4 text-white shadow-sm" style="background-color: #191A1C;">

          <div class="row align-items-center">
            <div class="col-md-8">
              <div class="d-flex justify-content-between align-items-center mb-2">
                <h4 class="mb-0">
                  <a href="{% url 'tournaments:tournament-detail' tournament.pk %}" class="text-decoration-none text-info">
                    {{ tournament.title }}
                  </a>
                </h4>
                <span class="badge bg-secondary small">{{ tournament.get_status_display }}</span>
              </div>

              <p class="mb-2 small text-white-50">{{ tournament.description }}</p>

              {% if tournament.start_at or tournament.end_at or tournament.prize_pool %}
              <p class="text-white small mb-2">
                {% if tournament.start_at %}
                  Start: {{ tournament.start_at|date:"d.m.Y" }}
                {% endif %}
                {% if tournament.end_at %}
                  — End: {{ tournament.end_at|date:"d.m.Y" }}
                {% endif %}
                {% if tournament.prize_pool %}
                  | Prize pool: {{ tournament.prize_pool }} UAH
                {% endif %}
              </p>
              {% endif %}

              {% if user.is_authenticated and tournament.pk in applied_tournaments %}
                <div class="badge bg-info text-dark p-2 small">
                  ✅ You have already applied
                </div>
              {% endif %}
            </div>

            <div class="col-md-4">
              {% if tournament.game.name == "Counter Strike 2" %}
                <img src="{% static 'game_covers/cs2.png' %}" alt="CS2" class="img-fluid rounded"
                     style="object-fit: cover; width: 100%; max-height: 180px;">
              {% elif tournament.game.name == "Dota 2" %}
                <img src="{% static 'game_covers/dota_2.png' %}" alt="Dota 2" class="img-fluid rounded"
                     style="object-fit: cover; width: 100%; max-height: 180px;">
              {% elif tournament.game.name == "FC 25" %}
                <img src="{% static 'game_covers/fc25.png' %}" alt="FC25" class="img-fluid rounded"
                     style="object-fit: cover; width: 100%; max-height: 180px;">
              {% elif tournament.game.name == "Fortnite" %}
                <img src="{% static 'game_covers/fortnite.png' %}" alt="Fortnite" class="img-fluid rounded"
                     style="object-fit: cover; width: 100%; max-height: 180px;">
              {% elif tournament.game.name == "PUBG" %}
                <img src="{% static 'game_covers/pubg.png' %}" alt="PUBG" class="img-fluid rounded"
                     style="object-fit: cover; width: 100%; max-height: 180px;">
{% endif %}
            </div>
          </div>

        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>There are no tournaments at the moment.</p>
  {% endif %}
</div>
{% endblock %}
